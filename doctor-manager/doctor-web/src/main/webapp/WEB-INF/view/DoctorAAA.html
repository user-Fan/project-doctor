<!DOCTYPE html>
<html>

<!-- source http://www.scnoob.com More templates http://www.scnoob.com/moban -->

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Inspire - Admin and Dashboard Template</title>

    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="assets/fonts/line-icons.css">

    <link rel="stylesheet" href="assets/plugins/morris/morris.css">

    <link rel="stylesheet" type="text/css" href="assets/css/main.css">

    <link rel="stylesheet" type="text/css" href="assets/css/responsive.css">

    <link rel="stylesheet" href="assets/plugins/morris/morris.css">

    <style>
        .inner-container {
            position: absolute;
            left: 0;
            overflow-x: hidden;
            overflow-y: scroll;
        }

        /* for Chrome 只针对谷歌浏览器*/
        .inner-container::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>

<body class="inner-container">

<div class="app header-default side-nav-dark">
    <div class="layout">
        <div class="page-container">


            <div class="main-content">
                <div class="container-fluid">

                    <div class="breadcrumb-wrapper row" id="addBranch">

                    </div>

                </div>
                <div class="container-fluid">
                    <div class="row" id="docterLists">
                        <div class="col-md-6 col-lg-6 col-xlg-4">
                            <div class="card card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-lg-3 text-center">
                                        <a href="#"><img src="assets/img/users/1.jpg" alt="user"
                                                         class="img-circle img-fluid"></a>
                                    </div>
                                    <div class="col-md-8 col-lg-9">
                                        <h3 class="box-title">系统管理员提示您</h3>
                                        <small>感谢使用</small>
                                        <address class="m-0">
                                            <p class="m-0">所有医生列表</p>
                                            <abbr title="Phone">P:</abbr> 请选择你要查看的医生
                                        </address>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-6 col-xlg-4">
                            <div class="card card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-lg-3 text-center">
                                        <a href="#"><img src="assets/img/users/2.jpg" alt="user"
                                                         class="img-circle img-fluid"></a>
                                    </div>
                                    <div class="col-md-8 col-lg-9">
                                        <h3 class="box-title">姓名栏目</h3>
                                        <small>性别：年龄</small>
                                        <address class="m-0">
                                            <p class="m-0">医生介绍
                                                <abbr title="Phone">P:</abbr> 电话号码
                                        </address>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="assets/js/jquery-min.js"></script>
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/jquery.app.js"></script>
<script src="assets/js/main.js"></script>
<script src="assets/plugins/morris/morris.min.js"></script>
<script src="assets/plugins/raphael/raphael-min.js"></script>
<script src="assets/js/dashborad2.js"></script>
<script type="text/javascript"></script>

<script type="text/javascript">
    $.ajax
    ({
        cache: false,
        async: false,
        dataType: 'json', type: 'post',
        url: "/getAllBranchItems",
        success: function (data) {
            var json = data;
            for (var key in json) {
                var uuid = Math.random().toString(36).substr(2);
                var head = "<div class='col-sm-1'><div class='dropdown m-b-10'><button class='btn btn-common dropdown-toggle' type='button' id='" + uuid + "' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>" + key + "</button><div class='dropdown-menu' aria-labelledby='" + uuid + "'>";
                var item = json[key];
                for (var i = 0; i < item.length; i++) {
                    head += "<a class='dropdown-item' style='cursor:pointer' onclick='docterList(" + "&quot;" + item[i].itemNum + "&quot;" + ")'>" + item[i].itemName + "</a>";
                }
                head += "</div></div></div>";
                $("#addBranch").append(head);
            }
        }
    });

    function docterList(msg) {
        $("#docterLists").empty();
        $("#docterLists").append("<div class='col-md-6 col-lg-6 col-xlg-4'><div class='card card-body'><div class='row align-items-center'><div class='col-md-4 col-lg-3 text-center'><a href='#'><img src='assets/img/users/1.jpg'  alt='user'class='img-circle img-fluid'></a></div><div class='col-md-8 col-lg-9'><h3 class='box-title'>系统管理员提示您</h3><small>感谢使用</small><address class='m-0'><p class='m-0'>所有医生列表</p><abbr title='Phone'>P:</abbr> 请选择你要查看的医生</address></div></div></div></div><div class='col-md-6 col-lg-6 col-xlg-4'><div class='card card-body'><div class='row align-items-center'><div class='col-md-4 col-lg-3 text-center'><a href='#'><img src='assets/img/users/2.jpg' alt='user'class='img-circle img-fluid'></a></div><div class='col-md-8 col-lg-9'><h3 class='box-title'>姓名栏目</h3><small>性别：年龄</small><address class='m-0'><p class='m-0'>医生介绍<abbr title='Phone'>P:</abbr> 电话号码</address></div></div></div></div>");

        $.ajax
        ({
            cache: false,
            async: false,
            dataType: 'json', type: 'post',
            url: "/getDoctors",
            data: {"itemParentNum": msg},
            success: function (data) {
                var json = data;
                for (var i = 0; i < json.length; i++) {
                    var doctor = JSON.stringify(json[i]);
                    $("#docterLists").append("<div class='col-md-6 col-lg-6 col-xlg-4'><div class='card card-body'><div class='row align-items-center'><div class='col-md-4 col-lg-3 text-center'><div class='text-center'><img type='button' src='assets/img/users/1.jpg' class='img-circle img-fluid'data-toggle='modal' data-target='.bs-example-modal-center' onclick='changeval("+ doctor+")'></button></div><div class='modal fade bs-example-modal-center' tabindex='-1' role='dialog'aria-labelledby='mySmallModalLabel' aria-hidden='true' style='display: none;'><div class='modal-dialog modal-dialog-centered'><div class='modal-content'><div class='modal-header'><h5 class='modal-title'>创建预约单</h5><button type='button' class='close'data-dismiss='modal' onclick='refush()' aria-hidden='true'>×</button></div><div class='modal-body'><form class='forms-sample' id='createOrder' ><div class='form-group row' style='display: none;'><label for='exampleInputUsername2'class='col-sm-3 col-form-label'>医生编号</label><div class='col-sm-9'><input type='text' class='form-control' name='doctorId'readonly='readonly' value="+json[i].doctorId+" id = 'doctorIdAAA'></div></div><div class='form-group row' ><label for='exampleInputUsername2'class='col-sm-3 col-form-label'>医生姓名</label><div class='col-sm-9'><input type='text' class='form-control' name='doctorName'readonly='readonly' value="+json[i].doctorName+" id = 'doctorIdBBB'></div></div><div class='form-group row'><label for='exampleInputEmail2'class='col-sm-3 col-form-label'>就诊时间</label><div class='col-sm-9'><input type='date' class='form-control' name='endTime'></div></div><div class='form-group row'><label for='exampleInputMobile'class='col-sm-3 col-form-label'>挂号原因</label><div class='col-sm-9'><input type='text' class='form-control' name='putReason'placeholder='你的挂号原因'></div></div><button type='button' id='apply' class='btn btn-common mr-3' onclick='createOrderAAA()'>创建订单</button><button class='btn btn-light' id='return'>返回</button></form></div></div></div></div></div><div class='col-md-8 col-lg-9'><h3 class='box-title'>"+ json[i].doctorName + "</h3><small>" +" 性别："+ json[i].denger+"</small><small>"+" 年龄：" + json[i].age + "</small><small>" +" 职称："+ json[i].doctorTitle + "</small><address class='m-0'><p class='m-0'>简介:</p><p class='m-0'>" + json[i].doctorIntroduce + "</p><abbr title='Phone'>电话:</abbr>"+json[i].doctorPhone + "</address></div></div></div></div>"
                    );
                }
            }
        });
    }

    function changeval(value) {
       /* alert(value);
        alert(JSON.stringify(value));*/
        $("#doctorIdAAA").attr({"value":value.doctorId});
        $("#doctorIdBBB").attr({"value":value.doctorName});
    }



    function createOrderAAA(){
        var arry = $("#createOrder").serializeArray();//序列化表单
        var obj = {};//分配内存空间
        for (var i = 0; i < arry.length; i++) {//数据类型为"自定义类的字段名=数据"后台会自动对数据进行匹配
            obj[arry[i].name] = arry[i].value;
        }
        var date = JSON.stringify(obj);
        $.ajax
        ({
            cache: false,
            async: false,
            dataType: 'json', type: 'post',
            url: "/createOrder",
            data: {"order": date},
            success: function (data) {
              if(data.result==0){
                  alert("订单创建失败");
                  eco_refresh123();
              }else{
                  alert("订单创建成功");
                  eco_refresh123();
                  var idd = data.id;
                  $("#apply").removeAttr("onclick");
                  $("#apply").attr("onclick","apply2("+idd+")");
               /*   $("#apply").click(apply2(idd));*/

              }
            },error:function () {
                alert("订单创建失败");
                eco_refresh123();
            }
        });
    }
    function eco_refresh123(){
        /*var _body = window.parent;
        var _iframe1=_body.document.getElementById('getPage');
        window.onbeforeunload=function(){};
        _iframe1.contentWindow.location.reload(true);*/
       /* $("#createOrder").reset();*/
    /*    document.getElementById('createOrder').style.display='none';*/
        document.getElementById('apply').innerText='立即支付';

        document.getElementById('return').style.display='none';
    }

    function apply2 (id) {
       /* alert(id);*/
        $.ajax
        ({
            cache: false,
            async: false,
            dataType: 'json',
            type: 'post',
            data:{"id":id},
            url: "/toapply",
            success: function (data) {
                if (data==1){

                    alert("支付成功");
                    history.go(0);

                } else {
                    alert("支付失败");
                    eco_refresh();
                }
            },error:function () {
                alert("支付失败");
                location = location;
            }
        });
    };

    function refush() {
        var _body = window.parent;
       var _iframe1=_body.document.getElementById('getPage');
       window.onbeforeunload=function(){};
       _iframe1.contentWindow.location.reload(true);
    }
</script>
</body>


</html>